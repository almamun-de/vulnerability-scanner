
import socket
import requests
import nmap
import ssl

# Target domain or IP
target = "example.com"  # Replace with your target

# Open ports scanning
def scan_ports(target):
    nm = nmap.PortScanner()
    nm.scan(target, '1-1024')  # Scans common ports
    for host in nm.all_hosts():
        print(f"\nOpen ports for {host}:")
        for proto in nm[host].all_protocols():
            ports = nm[host][proto].keys()
            for port in ports:
                print(f"Port {port}: {nm[host][proto][port]['state']}")

# HTTP security headers check
def check_security_headers(target):
    url = f"http://{target}"
    try:
        response = requests.get(url)
        headers = response.headers
        print("\nSecurity headers check:")
        
        security_headers = ['Content-Security-Policy', 'X-Content-Type-Options', 
                            'X-Frame-Options', 'Strict-Transport-Security', 'X-XSS-Protection']

        for header in security_headers:
            if header in headers:
                print(f"{header}: {headers[header]}")
            else:
                print(f"{header}: Missing")
    except Exception as e:
        print(f"Error checking security headers: {e}")

